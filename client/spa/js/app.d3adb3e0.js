(function(t){function e(e){for(var r,o,i=e[0],u=e[1],c=e[2],p=0,m=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(m.length)m.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={0:0},s=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var l=u;s.push([0,1]),n()})({0:function(t,e,n){t.exports=n("2f39")},1069:function(t,e,n){"use strict";var r=n("6eba"),a=n.n(r);a.a},"2f39":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"file",(function(){return z})),n.d(r,"hasItem",(function(){return M}));var a={};n.r(a),n.d(a,"saveFile",(function(){return D}));var s={};n.r(s),n.d(s,"saveFile",(function(){return F}));var o={};n.r(o),n.d(o,"token",(function(){return U})),n.d(o,"isAuthorized",(function(){return B})),n.d(o,"me",(function(){return V}));var i={};n.r(i),n.d(i,"saveToken",(function(){return H})),n.d(i,"setIsAuthorized",(function(){return J}));var u={};n.r(u),n.d(u,"registry",(function(){return Z})),n.d(u,"login",(function(){return Q})),n.d(u,"logOut",(function(){return K}));var c={};n.r(c),n.d(c,"isOpen",(function(){return et}));var l={};n.r(l),n.d(l,"open",(function(){return nt})),n.d(l,"close",(function(){return rt})),n.d(l,"toggle",(function(){return at}));var p={};n.r(p),n.d(p,"open",(function(){return st})),n.d(p,"close",(function(){return it})),n.d(p,"toggle",(function(){return ct}));n("ac1f"),n("5319"),n("96cf");var m=n("c973"),f=n.n(m),d=(n("5c7d"),n("7d6e"),n("e54f"),n("4439"),n("4605"),n("f580"),n("5b2b"),n("8753"),n("2967"),n("7e67"),n("d770"),n("dd82"),n("922c"),n("d7fb"),n("a533"),n("c32e"),n("a151"),n("8bc7"),n("e80f"),n("5fec"),n("e42f"),n("57fc"),n("d67f"),n("880e"),n("1c10"),n("9482"),n("e797"),n("4848"),n("53d0"),n("63b1"),n("e9fd"),n("195c"),n("64e9"),n("33c5"),n("4f62"),n("0dbc"),n("7c38"),n("0756"),n("4953"),n("81db"),n("2e52"),n("2248"),n("7797"),n("12a1"),n("ce96"),n("70ca"),n("2318"),n("24bd"),n("8f27"),n("3064"),n("c9a2"),n("8767"),n("4a8e"),n("b828"),n("3c1c"),n("21cb"),n("c00e"),n("e4a8"),n("e4d3"),n("f4d9"),n("fffd"),n("f645"),n("639e"),n("34ee"),n("b794"),n("af24"),n("7c9c"),n("7bb2"),n("64f7"),n("c382"),n("053c"),n("c48f"),n("f5d1"),n("3cec"),n("c00ee"),n("d450"),n("ca07"),n("14e3"),n("9393"),n("9227"),n("1dba"),n("674a"),n("de26"),n("6721"),n("9cb5"),n("ed9b"),n("fc83"),n("98e5"),n("605a"),n("ba60"),n("df07"),n("7903"),n("e046"),n("58af"),n("7713"),n("0571"),n("3e27"),n("6837"),n("3fc9"),n("0693"),n("bf41"),n("985d"),n("4e2f"),n("31cd"),n("2b0e")),h=n("14c0"),v=n("42d2"),g=n("b178");d["a"].use(g["b"],{config:{},lang:h["a"],iconSet:v["a"]});var b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"max-width":"768px",margin:"0 auto"},attrs:{id:"q-app"}},[[n(t.layout,{tag:"component"},[n("router-view",{key:t.$route.fullPath})],1)]],2)},w=[],y=n("bcf2"),x=n("bc59"),q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",{attrs:{view:"hHh Lpr fFf"}},[n("q-page-container",[n("router-view")],1)],1)},C=[],k={name:"EmptyLayout"},_=k,$=n("2877"),R=Object($["a"])(_,q,C,!1,null,null,null),P=R.exports,j={name:"App",data:function(){return{isLoading:!0,layout:null}},watch:{$route:{handler:function(){var t,e,n;this.layout=null!==(t=null===(e=Object(y["a"])(this.$route.matched,(function(t){return Object(x["a"])(t,"meta.layout")})))||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.layout)&&void 0!==t?t:P},immediate:!0}}},O=j,E=Object($["a"])(O,b,w,!1,null,null,null),L=E.exports,S=n("2f62"),A=n("0e44"),I=function(){return{items:null}};n("caad"),n("2532");function z(t){return t.items}function M(t,e){return function(t){return e.items.includes(t)}}function D(t,e){t.items=e}function F(t,e){var n=t.commit;n("saveFile",e)}var N={namespaced:!0,getters:r,mutations:a,actions:s,state:I},T=function(){return{token:null,userDetails:null,isAuthorized:!1}};function U(t){return t.token}function B(t){return t.isAuthorized}function V(t){return t.userDetails}function H(t,e){t.token=e.token,t.userDetails={id:e.id,login:e.login,avatar:e.avatar}}function J(t,e){t.isAuthorized=e}function Z(t,e){return G.apply(this,arguments)}function G(){return G=f()(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.commit,r("setIsAuthorized",!0),r("saveToken",n);case 3:case"end":return t.stop()}}),t)}))),G.apply(this,arguments)}function Q(t,e){return W.apply(this,arguments)}function W(){return W=f()(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.commit,r("setIsAuthorized",!0),r("saveToken",n);case 3:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}function K(t){return X.apply(this,arguments)}function X(){return X=f()(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,n("logOut"),n("setIsAuthorized",!1);case 3:case"end":return t.stop()}}),t)}))),X.apply(this,arguments)}var Y={namespaced:!0,getters:o,mutations:i,actions:u,state:T},tt=function(){return{openModel:!1}};function et(t){return t.openModel}function nt(t){t.openModel=!0}function rt(t){t.openModel=!1}function at(t){t.openModel=!t.openModel}function st(t){return ot.apply(this,arguments)}function ot(){return ot=f()(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,n("open");case 2:case"end":return t.stop()}}),t)}))),ot.apply(this,arguments)}function it(t){return ut.apply(this,arguments)}function ut(){return ut=f()(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,n("close");case 2:case"end":return t.stop()}}),t)}))),ut.apply(this,arguments)}function ct(t){return lt.apply(this,arguments)}function lt(){return lt=f()(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.commit,n("toggle");case 2:case"end":return t.stop()}}),t)}))),lt.apply(this,arguments)}var pt={namespaced:!0,getters:c,mutations:l,actions:p,state:tt};d["a"].use(S["a"]);var mt=Object(A["a"])({key:"me",paths:["auth"]}),ft=Object(A["a"])({key:"file",paths:["posts"]}),dt=new S["a"].Store({modules:{posts:N,auth:Y,model:pt},plugins:[mt,ft],strict:!1}),ht=dt,vt=(n("45fc"),n("8c4f")),gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",{attrs:{view:"hHh Lpr fFf"}},[n("navbar-top"),n("navbar-bottom"),n("q-page-container",[n("router-view")],1)],1)},bt=[],wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-footer",{staticClass:"bg-white text-black",attrs:{bordered:""}},[n("q-list",{staticClass:"flex justify-evenly"},[n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"nav-link relative-position flex flex-center cursor-pointer",attrs:{"active-class":"is-active",to:{name:"home"}}},[n("q-icon",{attrs:{size:"md",name:"home"}})],1),n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"nav-link relative-position flex flex-center cursor-pointer",attrs:{"active-class":"is-active"}},[n("label",{},[n("q-icon",{staticClass:"cursor-pointer",attrs:{size:"md",name:"add_circle_outline"}}),n("q-file",{staticClass:"d-none",attrs:{accept:"image/*"},on:{input:t.uploadFile}})],1)]),n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"nav-link relative-position flex flex-center cursor-pointer",attrs:{"active-class":"is-active",to:{name:"profile",params:{login:t.me.login}}}},[n("q-icon",{attrs:{size:"md",name:"account_circle"}})],1)],1)],1)},yt=[],xt=n("ded3"),qt=n.n(xt),Ct={name:"NavbarBottom",data:function(){return{}},computed:qt()({},Object(S["b"])({me:"auth/me"})),methods:{getMe:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$store.getters["auth/me"].login,e.next=3,t.$router.push({name:"profile",params:{login:n}});case 3:case"end":return e.stop()}}),e)})))()},uploadFile:function(t){var e=this;window.file=t;var n=new FileReader;n.onload=function(t){var n=t.target.result;e.$store.dispatch("posts/saveFile",n),e.$router.push({name:"poster"})},n.readAsDataURL(t)}}},kt=Ct,_t=(n("327b"),Object($["a"])(kt,wt,yt,!1,null,"cbae4d2c",null)),$t=_t.exports,Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-header",{staticClass:"flex justify-between q-px-md items-center bg-white",attrs:{bordered:""}},[n("q-btn",{staticClass:"q-pa-none text-black",attrs:{icon:"camera_alt",to:{name:"camera"},flat:"",round:"",size:"lg"}}),n("router-link",{staticClass:"q-mb-none text-h6 title",attrs:{to:"/home"}},[t._v("VueGram")])],1)},Pt=[],jt={name:"NavbarTop"},Ot=jt,Et=Object($["a"])(Ot,Rt,Pt,!1,null,null,null),Lt=Et.exports,St={name:"MainLayout",components:{NavbarTop:Lt,NavbarBottom:$t}},At=St,It=Object($["a"])(At,gt,bt,!1,null,null,null),zt=It.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fullscreen bg-blue text-white text-center q-pa-md flex flex-center"},[n("div",[n("div",{staticStyle:{"font-size":"30vh"}},[t._v("\n      404\n    ")]),n("div",{staticClass:"text-h2",staticStyle:{opacity:".4"}},[t._v("\n      Oops. Nothing here...\n    ")]),n("q-btn",{staticClass:"q-mt-xl",attrs:{color:"white","text-color":"blue",unelevated:"",to:"/",label:"Go Home","no-caps":""}})],1)])},Dt=[],Ft={name:"Error404"},Nt=Ft,Tt=Object($["a"])(Nt,Mt,Dt,!1,null,null,null),Ut=Tt.exports,Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",[n("q-card",{attrs:{flat:""}},[t.isLoadingUser?n("q-item",{staticClass:"full-width"},[n("q-item-section",{staticClass:"q-mr-sm col-4",attrs:{avatar:""}},[n("q-skeleton",{attrs:{type:"QAvatar",size:"6rem"}})],1),n("q-item-section",{staticClass:"col-8"},[n("q-item-label",{staticClass:"q-mb-sm"},[n("q-skeleton",{attrs:{type:"text",width:"65%"}})],1),n("q-item-label",{attrs:{caption:""}},[n("q-skeleton",{attrs:{type:"text",width:"20%"}})],1)],1)],1):n("user-profile",{attrs:{"profile-info":t.profileInfo}})],1),n("q-card",{staticClass:"q-py-sm",attrs:{flat:""}},[n("q-separator")],1),n("q-card",{attrs:{flat:""}},[t.isLoadingPosts?n("ul",{staticClass:"row q-col-gutter-sm q-py-sm"},t._l(t.skeletons,(function(t){return n("li",{key:t,staticClass:"col-4"},[n("q-skeleton",{attrs:{width:"100%",height:"185px",square:"",animation:"fade"}})],1)})),0):n("ul",{staticClass:"row q-col-gutter-sm q-py-sm"},t._l(t.posts,(function(e){return n("li",{key:e.id,staticClass:"col-4"},[n("router-link",{attrs:{to:"#!"}},[n("q-img",{attrs:{src:e.photo,ratio:4/3},scopedSlots:t._u([{key:"loading",fn:function(){return[n("q-skeleton",{attrs:{width:"100%",height:"500px"}})]},proxy:!0}],null,!0)})],1)],1)})),0)])],1)},Vt=[],Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-card",{staticClass:"row items-center justify-between q-px-md q-py-sm",attrs:{flat:""}},[n("div",{staticClass:"full-width row "},[n("div",{staticClass:"col-4 row items-center"},[n("q-avatar",{staticClass:"bg-primary text-white q-mr-sm overflow-hidden",attrs:{size:"6rem"}},[t.profileInfo.user.avatar||null===!t.profileInfo.user.avatar?t._e():n("img",{attrs:{src:t.profileInfo.user.avatar,alt:""}})])],1),n("div",{staticClass:"col-8"},[n("div",{staticClass:"user-info row items-center justify-between"},[n("h4",{staticClass:"q-mb-sm"},[t._v(t._s(t.profileInfo.user.login))])]),n("ul",{staticClass:"flex items-center"},[n("li",{staticClass:"flex items-center"},[n("b",{staticClass:"q-mr-sm"},[t._v(t._s(t.profileInfo.postsCount?t.profileInfo.postsCount:0))]),n("span",[t._v("posts")])])])])])])},Jt=[],Zt=n("84d4"),Gt={name:"UserProfile",props:{profileInfo:Zt["a"].object.isRequired},data:function(){return{imageupload:null,openModel:!1}},methods:{uploadFile:function(t){this.$emit("update-avatar",t)},showModel:function(){this.openModel=!this.openModel}}},Qt=Gt,Wt=Object($["a"])(Qt,Ht,Jt,!1,null,"2f844de8",null),Kt=Wt.exports,Xt=n("970b"),Yt=n.n(Xt),te=n("5bc3"),ee=n.n(te),ne=n("9523"),re=n.n(ne),ae=n("bc3a"),se=n.n(ae),oe=function(){function t(){Yt()(this,t)}return ee()(t,null,[{key:"getPosts",value:function(){var t=f()(regeneratorRuntime.mark((function t(){var e,n,r,a=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},n=e.query,r=void 0===n?{}:n,t.next=3,se.a.get("/api/posts",{params:r}).then((function(t){var e=t.data;a.result=e})).catch((function(t){a.result=t}));case 3:return t.abrupt("return",this.result);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"createPost",value:function(){var t=f()(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,se.a.post("/api/posts",e);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();re()(oe,"result",void 0);var ie=oe,ue=function(){function t(){Yt()(this,t)}return ee()(t,null,[{key:"create",value:function(){var t=f()(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,se.a.post("/api/users",e).then((function(t){n.result=t.data})).catch((function(t){var r=t.response.data;"users_login_key"===r.message.parent.constraint?n.result={status:r.status,message:"".concat(e.login," is exist")}:n.result={status:r.status,message:"".concat(e.email," is exist")}}));case 2:return t.abrupt("return",this.result);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"get",value:function(){var t=f()(regeneratorRuntime.mark((function t(){var e,n,r,a=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},n=e.query,r=void 0===n?{}:n,t.next=3,se.a.get("/api/users",{params:r}).then((function(t){var e=t.data;a.result={status:e.status,data:e.data}})).catch((function(t){var e=t.response.data;a.result={status:e.status,message:e.message}}));case 3:return t.abrupt("return",this.result);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),t}();re()(ue,"result",void 0);var ce=ue,le={name:"ProfilePage",components:{UserProfile:Kt},props:{login:Zt["a"].string},data:function(){return{user:null,profileInfo:{},isLoadingUser:!0,isLoadingPosts:!0,skeletons:9}},asyncComputed:{userDetails:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ce.get({query:{login:t.login}});case 2:if(n=e.sent,!n.data){e.next=7;break}return t.profileInfo.user=n.data,t.isLoadingUser=!1,e.abrupt("return",n.data);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))()},posts:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie.getPosts({query:{user:t.userDetails.id}});case 2:if(n=e.sent,r=n.data,!r){e.next=8;break}return t.profileInfo.postsCount=r.length,t.isLoadingPosts=!1,e.abrupt("return",r);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))()}}},pe=le,me=Object($["a"])(pe,Bt,Vt,!1,null,null,null),fe=me.exports,de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",[t.hasCameraSupport?n("div",{staticClass:"canvas"},[n("div",{staticClass:"camera-frame q-pa-md"},[n("video",{directives:[{name:"show",rawName:"v-show",value:!t.isCaptured,expression:"!isCaptured"}],ref:"video",staticClass:"video-frame",attrs:{autoplay:"",playsinline:""}}),n("canvas",{directives:[{name:"show",rawName:"v-show",value:t.isCaptured,expression:"isCaptured"}],ref:"canvas",staticClass:"full-width"})]),n("div",{staticClass:"form"},[t.isCaptured?n("div",{staticClass:"flex justify-between q-mt-md"},[n("q-btn",{attrs:{label:"Отменить",color:"negative"},on:{click:t.cancel}}),n("q-btn",{attrs:{label:"Опубликоват",color:"primary"},on:{click:t.submit}})],1):n("div",{staticClass:"full-width q-mt-md text-center"},[n("q-btn",{staticClass:"q-pa-xs",attrs:{round:"",outline:"",color:"red"},on:{click:t.captureImage}},[n("q-btn",{attrs:{color:"red",round:""}})],1)],1)])]):n("div",{staticClass:"bg-dark absolute-full"},[n("q-btn",{staticClass:"absolute-center",attrs:{flat:"","fab-mini":"","text-color":"white",label:"Разрешите использовать камеру"},on:{click:t.getAccess}})],1)])},he=[],ve=(n("4160"),n("e260"),n("c19f"),n("ace4"),n("d3b7"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),{name:"CameraPage",data:function(){return{photo:null,isCaptured:!1,hasCameraSupport:!0}},methods:{upload:function(t){this.photo=t;var e=this.$refs.canvas,n=e.getContext("2d"),r=new FileReader;r.onload=function(t){var r=new Image;r.onload=function(){e.width=r.width,e.height=r.height,n.drawImage(r,0,0)},r.src=t.target.result},this.$store.dispatch("posts/saveFile",this.photo),r.readAsDataURL(t)},initCamera:function(){var t=this;navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){t.$refs.video.srcObject=e})).catch((function(){t.hasCameraSupport=!1}))},captureImage:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n,r,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.isCaptured=!0,n=t.$refs,r=n.video,a=n.canvas,a.width=r.getBoundingClientRect().width,a.height=r.getBoundingClientRect().height,s=a.getContext("2d"),s.drawImage(r,0,0,a.width,a.height);case 6:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$refs.canvas,t.photo=n.toDataURL(),e.next=4,t.$store.dispatch("posts/saveFile",t.photo);case 4:return e.next=6,t.$router.push({name:"poster"});case 6:case"end":return e.stop()}}),e)})))()},dataURItoBlob:function(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),a=new Uint8Array(r),s=0;s<e.length;s++)a[s]=e.charCodeAt(s);var o=new Blob([r],{type:n});return o},cancel:function(){this.isCaptured=!this.isCaptured},disableCamera:function(){this.$refs.video.srcObject.getVideoTracks().forEach((function(t){t.stop()}))}},mounted:function(){this.initCamera()},beforeDestroy:function(){this.hasCameraSupport&&this.disableCamera()}}),ge=ve,be=(n("902e"),Object($["a"])(ge,de,he,!1,null,"66b25ea6",null)),we=be.exports,ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"flex flex-center q-px-lg"},[n("registry-form",{on:{registry:t.submit}})],1)},xe=[],qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"full-width text-center"},[n("q-form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit(e)}}},[n("q-input",{ref:"login",attrs:{hint:"Login",color:"primary",rules:[function(t){return!!t||"Login is missing"}]},model:{value:t.model.login,callback:function(e){t.$set(t.model,"login",e)},expression:"model.login"}}),n("q-input",{ref:"email",attrs:{hint:"E-mail",color:"primary",rules:[function(t){return!!t||"Email is missing"},t.isValidEmail]},model:{value:t.model.email,callback:function(e){t.$set(t.model,"email",e)},expression:"model.email"}}),n("q-input",{ref:"password",attrs:{type:"password",hint:"Password",color:"primary",rules:[function(t){return!!t&&t.length>=6||"Please use maximum 6 characters"}]},model:{value:t.model.password,callback:function(e){t.$set(t.model,"password",e)},expression:"model.password"}}),n("q-btn",{staticClass:"q-mt-md text-capitalize",attrs:{type:"submit",color:"primary",label:"Sign up"}})],1),n("q-btn",{staticClass:"q-mt-md text-capitalize absolute-top-right",attrs:{to:{name:"login"},flat:"",color:"primary",label:"Sign in"}})],1)},Ce=[],ke={name:"RegistryForm",data:function(){return{model:{login:null,email:null,password:null}}},methods:{isValidEmail:function(t){var e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(t)||"Invalid email"},onSubmit:function(){this.$refs.email.validate(),this.$refs.login.validate(),this.$refs.password.validate(),this.$refs.email.hasError||this.$refs.login.hasError||this.$refs.password.hasError?this.formHasError=!0:this.$emit("registry",this.model)}}},_e=ke,$e=Object($["a"])(_e,qe,Ce,!1,null,"ef3773aa",null),Re=$e.exports,Pe={name:"RegistryPage",components:{RegistryForm:Re},methods:{submit:function(t){var e=this;return f()(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,ce.create(t);case 2:if(r=n.sent,201!==r.status){n.next=10;break}return n.next=6,e.$store.dispatch("auth/registry",r.data);case 6:return n.next=8,e.$router.push({name:"home"});case 8:n.next=11;break;case 10:e.$q.notify({message:r.message,position:"top",type:"warning"});case 11:case"end":return n.stop()}}),n)})))()}}},je=Pe,Oe=Object($["a"])(je,ye,xe,!1,null,"29695ab6",null),Ee=Oe.exports,Le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"flex flex-center q-px-lg"},[n("login-form",{on:{login:t.submit}})],1)},Se=[],Ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"full-width text-center"},[n("q-form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit(e)}}},[n("q-input",{ref:"login",attrs:{hint:"Login",color:"primary","label-color":"primary",rules:[function(t){return!!t||"Login is missing"}]},model:{value:t.model.login,callback:function(e){t.$set(t.model,"login",e)},expression:"model.login"}}),n("q-input",{ref:"password",attrs:{type:"password",hint:"Password",color:"primary",rules:[function(t){return!!t&&t.length>=6||"Please use maximum 6 characters"}],"label-color":"primary"},model:{value:t.model.password,callback:function(e){t.$set(t.model,"password",e)},expression:"model.password"}}),n("q-btn",{staticClass:"q-mt-md text-capitalize",attrs:{type:"submit",color:"primary",label:"Sign in"}})],1),n("q-btn",{staticClass:"q-mt-md text-capitalize absolute-top-right",attrs:{to:{name:"registry"},flat:"",color:"primary",label:"Sign up"}})],1)},Ie=[],ze={name:"LoginForm",data:function(){return{model:{login:null,password:null}}},methods:{onSubmit:function(){this.$refs.login.validate(),this.$refs.password.validate(),this.$refs.login.hasError||this.$refs.password.hasError?this.formHasError=!0:this.$emit("login",this.model)}}},Me=ze,De=Object($["a"])(Me,Ae,Ie,!1,null,"20fa5690",null),Fe=De.exports,Ne=function(){function t(){Yt()(this,t)}return ee()(t,null,[{key:"login",value:function(){var t=f()(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,se.a.get("/api/users/login",{params:e}).then((function(t){var e=t.data;n.result=e})).catch((function(t){var e=t.response.data;n.result={status:e.status,message:e.message}}));case 2:return t.abrupt("return",this.result);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();re()(Ne,"result",void 0);var Te=Ne,Ue={name:"LoginPage",components:{LoginForm:Fe},methods:{submit:function(t){var e=this;return f()(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Te.login(t);case 2:if(r=n.sent,200!==r.status){n.next=10;break}return n.next=6,e.$store.dispatch("auth/login",r.data);case 6:return n.next=8,e.$router.push({name:"home"});case 8:n.next=11;break;case 10:e.$q.notify({message:r.message,position:"top",type:"warning"});case 11:case"end":return n.stop()}}),n)})))()}}},Be=Ue,Ve=Object($["a"])(Be,Le,Se,!1,null,"196688de",null),He=Ve.exports,Je=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",[t.isLoading?n("div",t._l(t.skeletons,(function(t){return n("q-card",{key:t,staticClass:"q-mb-sm",attrs:{flat:"",bordered:""}},[n("q-item",[n("q-item-section",{attrs:{avatar:""}},[n("q-skeleton",{attrs:{type:"QAvatar",animation:"fade"}})],1),n("q-item-section",[n("q-item-label",[n("q-skeleton",{attrs:{type:"text",animation:"fade"}})],1),n("q-item-label",{attrs:{caption:""}},[n("q-skeleton",{attrs:{type:"text",animation:"fade"}})],1)],1)],1),n("q-skeleton",{attrs:{height:"400px",square:"",animation:"fade"}}),n("q-card-section",[n("q-skeleton",{staticClass:"text-subtitle2",attrs:{type:"text",animation:"fade"}}),n("q-skeleton",{staticClass:"text-subtitle2",attrs:{type:"text",width:"50%",animation:"fade"}})],1)],1)})),1):n("div",[t.posts?n("div",t._l(t.posts,(function(t){return n("post-card",{key:t.id,staticClass:"q-my-sm",attrs:{post:t}})})),1):n("div",{staticClass:"absolute-center"},[n("p",[t._v("Post not found :(")])])])])},Ze=[],Ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-card",{staticClass:"full-width",attrs:{bordered:"",flat:""}},[n("div",{staticClass:"flex justify-between q-pa-sm"},[n("router-link",{staticClass:"flex items-center q-mb-none",attrs:{to:{name:"profile",params:{login:t.post.user.login}},tag:"p"}},[n("q-avatar",{staticClass:"bg-primary text-white q-mr-sm",attrs:{size:"xl"}},[t.post.user.avatar?n("img",{attrs:{src:t.post.user.avatar,alt:""}}):t._e()]),n("div",{staticClass:"flex-center"},[n("router-link",{staticClass:"q-mb-none cursor-pointer",attrs:{to:{name:"profile",params:{login:t.post.user.login}},tag:"b"}},[t._v("\n          "+t._s(t.post.user.login)+"\n        ")]),"null"!==t.post.location&&""!==t.post.location?n("p",{staticClass:"q-mb-none location"},[t._v("\n          "+t._s(t.post.location)+"\n        ")]):t._e()],1)],1)],1),n("q-separator"),n("q-img",{attrs:{src:t.post.photo,alt:t.post.body,ratio:4/3,contain:""},scopedSlots:t._u([{key:"loading",fn:function(){return[n("q-skeleton",{attrs:{width:"100%",height:"500px"}})]},proxy:!0}])}),n("q-separator"),n("div",{staticClass:"flex justify-between q-px-sm "},[n("post-comment",{attrs:{body:t.post.comment,"user-name":t.post.user.login,date:t.formattedDate}})],1)],1)},Qe=[],We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-item",{staticClass:"q-pa-sm q-ma-none flex"},[n("div",{staticClass:"flex"},[n("router-link",{staticClass:"q-mr-md cursor-pointer",attrs:{to:{name:"profile",params:{login:t.userName}},tag:"b"}},[t._v("\n      "+t._s(t.userName)+"\n    ")]),t.body&&"null"===t.body?t._e():n("v-clamp",{attrs:{ellipsis:"...",tag:"p","max-lines":2}},[t._v(t._s(t.body))])],1),n("div",[t._v("\n    "+t._s(t.date)+"\n  ")])])},Ke=[],Xe={name:"PostComment",props:{date:Zt["a"].string.isRequired,userName:Zt["a"].string.isRequired,body:Zt["a"].string.isRequired}},Ye=Xe,tn=Object($["a"])(Ye,We,Ke,!1,null,"29b47dfe",null),en=tn.exports,nn={name:"PostCard",components:{PostComment:en},props:{post:Zt["a"].object.isRequired},data:function(){return{isLoadImage:!1}},computed:{formattedDate:function(){return g["a"].formatDate(this.post.date,"dddd D MMMM")}}},rn=nn,an=(n("1069"),Object($["a"])(rn,Ge,Qe,!1,null,"bdeb5276",null)),sn=an.exports,on={name:"HomePage",components:{PostCard:sn},data:function(){return{netStatus:!0,isLoading:!0,skeletons:3}},mounted:function(){this.networkStatus()},asyncComputed:{posts:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.netStatus){e.next=8;break}return e.next=3,ie.getPosts();case 3:if(n=e.sent,200!==n.status){e.next=7;break}return t.isLoading=!1,e.abrupt("return",n.data);case 7:return e.abrupt("return",[]);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))()}},methods:{networkStatus:function(){var t=window.navigator.onLine;this.netStatus=t}}},un=on,cn=Object($["a"])(un,Je,Ze,!1,null,null,null),ln=cn.exports,pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",[n("div",{staticClass:"camera-frame q-pa-md"},[n("q-img",{ref:"img",staticClass:"full-width",attrs:{src:t.file,contain:"",alt:""}})],1),n("div",{staticClass:"q-pa-sm form"},[n("q-input",{staticClass:"q-mb-md",attrs:{outlined:"","bg-color":"grey-4",placeholder:"Комментария"},model:{value:t.post.comment,callback:function(e){t.$set(t.post,"comment",e)},expression:"post.comment"}}),n("q-input",{attrs:{outlined:"","bg-color":"grey-4",placeholder:"Location"},scopedSlots:t._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:t.getLocation}})]},proxy:!0}]),model:{value:t.post.location,callback:function(e){t.$set(t.post,"location",e)},expression:"post.location"}}),n("q-btn",{attrs:{label:"Сохранить",color:"primary"},on:{click:t.createPost}})],1)])},mn=[],fn=(n("99af"),n("a9e3"),{name:"PosterPage",props:{},data:function(){return{post:{id:Object(g["c"])(),comment:null,photo:null,date:null,user:null,location:null}}},computed:qt()({},Object(S["b"])({file:"posts/file",me:"auth/me"})),methods:{createPost:function(){var t=this;return f()(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.post,r=new FormData,n.date=Number(new Date),n.photo=t.dataURItoBlob(t.file),n.user=t.me.id,r.append("comment",n.comment),r.append("date",n.date),r.append("user",n.user),r.append("location",n.location),r.append("file",n.photo,"".concat(n.id,".png")),e.next=12,ie.createPost(r).then((function(e){201===e.status&&t.$router.push({name:"home"})})).catch((function(e){var n=e.response.data;504===n.status&&t.$q.notify({message:"Please check network connection",position:"top",type:"negative"})}));case 12:case"end":return e.stop()}}),e)})))()},getLocation:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){t.getCityAndCountry(e.coords)}),(function(){t.$q.notify({message:"Can not get location. Please check network connection",position:"top",color:"danger"})}),{timeout:7e3})},getCityAndCountry:function(t){var e=this,n="https://geocode.xyz/".concat(t.latitude,",").concat(t.longitude,"?json=1");this.$axios.get(n).then((function(t){e.successLocation(t)})).catch((function(t){}))},successLocation:function(t){this.post.location=t.data.city,t.data.country&&(this.post.location+=", ".concat(t.data.country," "))},dataURItoBlob:function(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),a=new Uint8Array(r),s=0;s<e.length;s++)a[s]=e.charCodeAt(s);var o=new Blob([r],{type:n});return o}}}),dn=fn,hn=(n("77e8"),Object($["a"])(dn,pn,mn,!1,null,"32251a51",null)),vn=hn.exports,gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-pull-to-refresh",{attrs:{color:"primary","bg-color":"white",icon:"autorenew"},on:{refresh:t.refresh}},[n("div",{staticClass:"column flex-center"},[n("q-img",{attrs:{src:"images/no-net-connection.jpg",ratio:16/9}}),n("div",{class:t.titleClass},[t._v("\n      "+t._s(t.title)+"\n    ")]),"No Internet Connection"===t.title?n("div",{staticClass:"body text-caption q-mx-auto q-mt-md"},[t._v("\n      Please check your internet connection and pull to refresh\n    ")]):t._e()],1)])},bn=[],wn={name:"EmptyPage",data:function(){return{title:"No Internet Connection",titleClass:"title q-mx-auto q-mt-lg text-caption"}},methods:{refresh:function(t){var e=this;window.navigator.onLine?(this.title="Connected",this.titleClass="title q-mx-auto q-mt-lg text-caption text-positive",setTimeout(f()(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t(),n.next=3,e.$router.push({name:"home"});case 3:case"end":return n.stop()}}),n)}))),3e3)):(this.titleClass="title q-mx-auto q-mt-lg text-caption  text-negative",setTimeout((function(){e.titleClass="title q-mx-auto q-mt-lg text-caption",t()}),3e3))}}},yn=wn,xn=(n("4ec6"),Object($["a"])(yn,gn,bn,!1,null,"4397a416",null)),qn=xn.exports,Cn=[{path:"/",redirect:{name:"home"}},{path:"/home",name:"home",meta:{layout:zt,protected:!0},component:ln},{path:"/profile/:login",name:"profile",meta:{layout:zt},component:fe,props:function(t){return{login:t.params.login}}},{path:"/camera",name:"camera",meta:{layout:zt},component:we},{path:"/poster/",name:"poster",meta:{layout:zt},component:vn},{path:"/registry",name:"registry",meta:{layout:P},component:Ee},{path:"/login",name:"login",meta:{layout:P},component:He},{path:"/empty",name:"empty",meta:{layout:P},component:qn},{path:"*",component:Ut}],kn=Cn;d["a"].use(vt["a"]);var _n=new vt["a"]({routes:kn,mode:"history",base:"/",scrollBehavior:function(t){if(t.hash){var e=document.querySelector(t.hash);e&&window.scrollTo({top:e.offsetTop,behavior:"smooth"})}else window.scrollTo({top:0,behavior:"smooth"})}});_n.beforeEach((function(t,e,n){!ht.getters["auth/isAuthorized"]&&t.matched.some((function(t){return t.meta.protected}))?n({name:"registry",query:{redirectTo:t.fullPath}}):!1===window.navigator.onLine?n({name:"empty",query:{redirectTo:t.fullPath}}):n()}));var $n=_n,Rn=function(){return Pn.apply(this,arguments)};function Pn(){return Pn=f()(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("function"!==typeof ht){t.next=6;break}return t.next=3,ht({Vue:d["a"]});case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=ht;case 7:if(e=t.t0,"function"!==typeof $n){t.next=14;break}return t.next=11,$n({Vue:d["a"],store:e});case 11:t.t1=t.sent,t.next=15;break;case 14:t.t1=$n;case 15:return n=t.t1,e.$router=n,r={router:n,store:e,render:function(t){return t(L)}},r.el="#q-app",t.abrupt("return",{app:r,store:e,router:n});case 20:case"end":return t.stop()}}),t)}))),Pn.apply(this,arguments)}var jn=n("a925"),On={failed:"Action failed",success:"Action was successful"},En={"en-us":On};d["a"].use(jn["a"]);var Ln=new jn["a"]({locale:"en-us",fallbackLocale:"en-us",messages:En}),Sn=function(t){var e=t.app;e.i18n=Ln};d["a"].prototype.$axios=se.a;var An=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("vue-json-pretty",{attrs:{"show-double-quotes":!1,"show-length":"","highlight-mouseover-node":"",deep:3,"custom-value-formatter":t.formatter,data:t.value}})},In=[],zn=(n("2ca0"),n("838b")),Mn=n.n(zn),Dn={name:"JsonPrinter",components:{VueJsonPretty:Mn.a},props:{value:Zt["a"].any.isRequired},methods:{formatter:function(t){return"string"===typeof t&&(t.startsWith("http://")||t.startsWith("https://"))?'<a href="'.concat(t,'" target="_blank" referrerpolicy="no-referrer">').concat(t,"</a>"):t}}},Fn=Dn,Nn=Object($["a"])(Fn,An,In,!1,null,"98fc0a5c",null);Nn.exports;d["a"].component("json-printer",{name:"JsonPrinter",template:"\n      <span></span>\n    "});var Tn=n("3f87");d["a"].component("v-clamp",Tn["a"]);var Un=n("3003");d["a"].use(Un["a"]);var Bn="/";function Vn(){return Hn.apply(this,arguments)}function Hn(){return Hn=f()(regeneratorRuntime.mark((function t(){var e,n,r,a,s,o,i,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Rn();case 2:e=t.sent,n=e.app,r=e.store,a=e.router,s=!1,o=function(t){s=!0;var e=Object(t)===t?a.resolve(t).route.fullPath:t;window.location.href=e},i=window.location.href.replace(window.location.origin,""),u=[Sn,void 0,void 0,void 0,void 0],c=0;case 11:if(!(!1===s&&c<u.length)){t.next=28;break}if("function"===typeof u[c]){t.next=14;break}return t.abrupt("continue",25);case 14:return t.prev=14,t.next=17,u[c]({app:n,router:a,store:r,Vue:d["a"],ssrContext:null,redirect:o,urlPath:i,publicPath:Bn});case 17:t.next=25;break;case 19:if(t.prev=19,t.t0=t["catch"](14),!t.t0||!t.t0.url){t.next=24;break}return window.location.href=t.t0.url,t.abrupt("return");case 24:return t.abrupt("return");case 25:c++,t.next=11;break;case 28:if(!0!==s){t.next=30;break}return t.abrupt("return");case 30:new d["a"](n);case 31:case"end":return t.stop()}}),t,null,[[14,19]])}))),Hn.apply(this,arguments)}Vn()},"31cd":function(t,e,n){},"327b":function(t,e,n){"use strict";var r=n("c996"),a=n.n(r);a.a},"4ec6":function(t,e,n){"use strict";var r=n("5207"),a=n.n(r);a.a},"50da":function(t,e,n){},5207:function(t,e,n){},"6eba":function(t,e,n){},"77e8":function(t,e,n){"use strict";var r=n("50da"),a=n.n(r);a.a},"902e":function(t,e,n){"use strict";var r=n("e53b"),a=n.n(r);a.a},c996:function(t,e,n){},e53b:function(t,e,n){}});